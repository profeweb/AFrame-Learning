<html>
  <head>
	<script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <style>
      #overlay {
        position: absolute;
        z-index: 1;
        top: 0;
        left: 0;
        width: 100%;
        padding: 10px 0;
        /*   height: 100px; */
        display: flex;
        align-items: center;
        justify-content: center;
        opacity: 1;
        background-color: rgba(0, 0, 0, 0.6);
        color: #ffffff;
      }
      #overlay > div {
        text-align: center;
      }
      #overlay > div > button {
        background: transparent;
        color: #ffffff;
        border: 1px solid #ffffff;
        padding: 0.8em 2em;
        cursor: pointer;
        text-transform: uppercase;
      }

      a-scene {
        display: block;
        position: relative;
        height: 100%;
        width: 100%;
      }

      #app {
        position: relative;
      }
    </style>
  </head>
  <body>
    <script>
      AFRAME.registerComponent('slide', {

        schema: {
          origin: {type: 'selector'},
          target: {type: 'selector'},
          velocitat: {type: 'number', default: 0.01 },
        },

        init: function () {

          var self = this;

          this.amt = 0;
          this.start = false;
          this.end = false;

          this.originVector = this.data.origin.object3D.position;
          this.targetVector = this.data.target.object3D.position;

          this.el.setAttribute('position', this.originVector);

          this.el.addEventListener('start', function (e){
            self.start = true;
            console.log("STARTED");
          });

        },

        tick: function (time, timeDelta) {

          if(this.start && !this.end) {

            this.el.setAttribute('position', {
              x: interpola(this.originVector.x, this.targetVector.x, this.amt),
              y: interpola(this.originVector.y, this.targetVector.y, this.amt),
              z: interpola(this.originVector.z, this.targetVector.z, this.amt),
            });

            this.amt += this.data.velocitat;

            if(this.amt>=1+this.data.velocitat){
              this.end = true;
            }

          }
        }

      });

      function interpola(value1, value2, amt){
        return value1 + (value2 - value1)*amt;
      }

      function slide(){
        document.querySelector('#bolla').emit('start');
      }

    </script>

    <div id="overlay">
      <div>
        <button onclick="slide();">SLIDE</button>
      </div>
    </div>

    <a-scene background="color:#AAA">

      <a-sphere id="inici"  position="-10 1 -15" material="color:black" radius="0.1"></a-sphere>
      <a-sphere id="final" position="+10 1 -15" material="color:black" radius="0.1"></a-sphere>
      <a-sphere id="bolla" slide="origin:#inici; target:#final;velocitat:0.5;" material="color:red" radius="0.5"></a-sphere>

    </a-scene>
  </body>
</html>
