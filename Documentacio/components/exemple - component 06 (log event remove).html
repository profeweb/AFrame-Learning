<html>
  <head>
	<script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <style>
      #overlay {
        position: absolute;
        z-index: 1;
        top: 0;
        left: 0;
        width: 100%;
        padding: 10px 0;
        /*   height: 100px; */
        display: flex;
        align-items: center;
        justify-content: center;
        opacity: 1;
        background-color: rgba(0, 0, 0, 0.6);
        color: #ffffff;
      }
      #overlay > div {
        text-align: center;
      }
      #overlay > div > button {
        background: transparent;
        color: #ffffff;
        border: 1px solid #ffffff;
        padding: 0.8em 2em;
        cursor: pointer;
        text-transform: uppercase;
      }

      a-scene {
        display: block;
        position: relative;
        height: 100%;
        width: 100%;
      }

      #app {
        position: relative;
      }
    </style>
  </head>
  <body>
    <script>
        AFRAME.registerComponent('log', {

          schema: {
            event: { type: 'string', default: '' },
            message : { type: 'string', default: 'Hello, World!' },
          },

          init: function () {
            var self = this;
            this.eventHandlerFn = function () { console.log(self.data.message); };
          },


          update: function (oldData) {

            var data = this.data;
            var el = this.el;

            if (oldData.event && data.event !== oldData.event) {
              el.removeEventListener(oldData.event, this.eventHandlerFn);
            }

            if (data.event) {
              el.addEventListener(data.event, this.eventHandlerFn);
            } else {
              console.log(data.message);
            }
          },

          remove: function () {
            var data = this.data;
            var el = this.el;

            if (data.event) {
              el.removeEventListener(data.event, this.eventHandlerFn);
            }
          }


        });

        function benvinguda(){
          console.log("Emet Event de Benvinguda!");
          document.querySelector('a-box').emit('benvinguda');
        }

        function despedida(){
          var el = document.querySelector('a-box');
          el.setAttribute('log', {event: 'despedida', message: 'Adeu Paco!'});
          console.log("Emet Event de Despedida!");
          el.emit('despedida');
        }

        function elimina(){
          console.log("Elimina el component 'log'!");
          var el = document.querySelector('a-box');
          el.removeAttribute('log');
          el.emit('EventQualsevol');

        }


    </script>
    <div id="overlay">
      <div>
        <button onclick="benvinguda();">BENVINGUDA</button>
        <button onclick="despedida();">DESPEDIDA</button>
        <button onclick="elimina();">ELIMINA</button>
      </div>
    </div>
    <a-scene>
      <a-box log="event:benvinguda; message:Hola Paco!" position="0 1.6 -3" color="red"></a-box>
    </a-scene>
  </body>
</html>
