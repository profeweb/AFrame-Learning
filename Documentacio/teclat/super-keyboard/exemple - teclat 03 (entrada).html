<!DOCTYPE html>
<html>
<head>
    <title>A-Frame: Simple Keyboard Input</title>
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="../../../Components/a-frame-super-keyboard/aframe-super-keyboard.min.js"></script>
</head>

<body>
<script>

    AFRAME.registerComponent('keyboard-input', {

        init: function() {
            let self = this;

            this.el.addEventListener('superkeyboardinput', function(event) {
                let text = event.detail.value;

                // text també accessible a través de: self.el.getAttribute("super-keyboard")["value"]

                console.log("Input: " + text);

                // esborra la barra d'entrada (sense fer que el teclat desaparegui).
                self.el.setAttribute( "super-keyboard", "value", "" );

                // canvia el color de l'esfera
                document.getElementById("sphere").setAttribute("color", text);
            });

            // Event de tancament del teclat (dismiss) per part de l'usuari
            this.el.addEventListener('superkeyboarddismiss', function(event) {
                // En tancar feim esborrar el text, sense enviar-lo (submit).
                console.log("Input esborrat.");
                self.el.setAttribute( "super-keyboard", "value", "" );
            });
        },

        tick: function (time, timeDelta) {
            // obliga al teclat a estar visible després dels events d'entrada (input) o tancament (dismiss).
            if ( !this.el.object3D.visible )
                this.el.object3D.visible = true;
        }

    });

</script>

<a-scene background="color:#222">

    <!-- Cursor per Desktop mode -->
    <a-entity id="mouseCursor" cursor="rayOrigin: mouse"></a-entity>

    <!-- Esfera que canvia en funcio del teclat -->
    <a-sphere id="sphere" radius="2" position="0 2 -8" color="gray" material="" geometry=""></a-sphere>

    <!-- Super-teclat amb configuració de password -->
    <a-entity id="keyboard" super-keyboard="hand: #mouseCursor; imagePath:../../../Components/a-frame-super-keyboard/"
              position="0 1.5 -0.5" rotation="-30 0 0"  keyboard-input>
    </a-entity>
</a-scene>

</body>
</html>